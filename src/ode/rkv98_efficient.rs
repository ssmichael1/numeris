//! Verner 9(8) Efficient — 26 stages, order 9(8), 8th-degree interpolant.
//!
//! Source: <https://www.sfu.ca/~jverner/RKV98.IIa.Efficient.00000034399.240714.CoeffsOnlyFLOAT6040>

use super::adaptive::RKAdaptive;

/// Verner 9(8) Efficient — 26 stages, order 9(8).
///
/// Has 10 extra stages beyond the 16 core stages to support
/// 8th-degree dense interpolation.
pub struct RKV98Efficient;

const BHAT: [f64; 26] = [
    0.018_972_105_324_811_013,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    3.408_110_314_549_493_8,
    0.126_032_388_382_092_09,
    0.118_837_506_345_114_98,
    0.249_104_199_783_868_76,
    -3.269_966_219_928_978_2,
    0.302_379_810_022_888_3,
    0.0,
    0.0,
    0.046_529_895_520_709_24,
    0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0,
];

impl RKAdaptive<26, 9> for RKV98Efficient {
    const ORDER: usize = 9;
    const FSAL: bool = false;

    const C: [f64; 26] = [
        0.0, 0.035_71, 0.099_060_280_912_674_14, 0.148_590_421_369_011_21,
        0.613_4, 0.232_735_947_360_562_68, 0.553_864_052_639_437_32,
        0.655_5, 0.491_625, 0.068_58, 0.253,
        0.662_064_179_541_204_6, 0.830_9, 0.899_8, 1.0, 1.0, 1.0,
        0.737_501_813_998_881, 0.749, 0.65, 0.487,
        0.009_7, 0.138, 0.249, 0.439, 0.794,
    ];

    const B: [f64; 26] = [
        0.015_006_690_149_797_248,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        -1.055_180_992_746_381_3,
        0.238_494_726_378_218_31,
        0.128_815_177_428_299_14,
        0.227_662_311_104_621_56,
        1.229_532_587_437_517_4,
        0.046_249_766_628_103_835,
        0.138_619_631_936_629_39,
        0.030_800_101_683_194_354,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0,
    ];

    const BERR: [f64; 26] = {
        let mut berr = [0.0; 26];
        let mut ix: usize = 0;
        while ix < 26 {
            berr[ix] = RKV98Efficient::B[ix] - BHAT[ix];
            ix += 1;
        }
        berr
    };

    #[rustfmt::skip]
    const A: [[f64; 26]; 26] = [
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.035_71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [-0.038_337_356_366_770_17, 0.137_397_637_279_444_31, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.037_147_605_342_252_803, 0.0, 0.111_442_816_026_758_41, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [2.674_764_429_871_505, 0.0, -9.982_382_134_885_294, 7.921_017_705_013_789, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.052_421_040_505_773_51, 0.0, 0.0, 0.179_691_118_917_595_31, 0.000_623_787_937_193_856_83, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.159_249_222_364_763_21, 0.0, 0.0, -0.429_842_987_724_108_75, 0.066_652_665_427_260_88, 0.757_805_152_571_521_99, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.072_833_333_333_333_33, 0.0, 0.0, 0.0, 0.0, 0.335_934_459_066_510_37, 0.246_732_207_600_156_3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.072_975_585_937_5, 0.0, 0.0, 0.0, 0.0, 0.334_800_972_969_933_35, 0.118_415_823_905_066_65, -0.034_567_382_812_5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.049_112_136_634_520_964, 0.0, 0.0, 0.0, 0.0, 0.039_838_573_613_086_52, 0.106_967_528_893_935_48, -0.021_742_591_654_586_476, -0.105_595_647_486_956_49, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [-0.027_079_888_186_412_805, 0.0, 0.0, 0.0, 0.0, 0.033_3, -0.164_552_607_003_605_71, 0.034_282_663_064_973_9, 0.158_526_406_443_922_1, 0.218_523_425_681_122_51, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.055_846_577_691_088_63, 0.0, 0.0, 0.0, 0.0, 0.091_665_331_666_725_39, 0.239_239_965_552_362_7, 0.010_238_347_122_484_149, -0.002_679_331_322_859_542_4, 0.042_356_241_814_742_85, 0.225_397_047_016_660_42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [-0.480_251_051_272_519_6, 0.0, 0.0, 0.0, 0.0, -6.359_610_162_555_93, -0.276_231_389_804_084_14, -6.500_796_633_979_846_7, 0.573_476_587_704_095_7, 1.347_125_994_868_138_8, 5.936_840_409_706_221, 6.590_346_245_333_924_7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.330_753_306_767_140_1, 0.0, 0.0, 0.0, 0.0, 5.956_207_776_829_962, -0.486_831_640_048_152_8, 4.462_055_288_206_771, 0.741_025_823_144_207_18, -0.711_819_203_457_591_3, -5.454_619_594_516_665_4, -4.140_803_729_244_709_7, 0.203_831_972_319_038_65, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [-0.584_711_112_299_894_4, 0.0, 0.0, 0.0, 0.0, -12.412_684_171_162_67, 1.360_245_445_660_928_1, -22.426_105_311_118_68, -0.882_885_705_586_545_8, 1.770_155_128_538_230_5, 12.158_096_519_185_34, 22.230_375_204_077_607, -0.663_448_376_020_124_9, 0.450_962_378_725_813_72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [1.940_575_549_810_648_7, 0.0, 0.0, 0.0, 0.0, 21.977_984_081_145_563, 0.823_074_732_698_472_8, 68.164_416_836_263_55, -3.117_097_463_620_266_7, -4.568_841_021_822_439_6, -18.741_909_871_262_65, -66.577_118_396_378_32, 1.098_915_553_165_441_8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.015_006_690_149_797_248, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.055_180_992_746_381_3, 0.238_494_726_378_218_31, 0.128_815_177_428_299_14, 0.227_662_311_104_621_56, 1.229_532_587_437_517_4, 0.046_249_766_628_103_835, 0.138_619_631_936_629_39, 0.030_800_101_683_194_354, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.015_718_010_614_177_88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.485_340_345_265_736_3, 0.210_778_756_890_454_67, 0.126_980_241_305_335_42, 0.231_968_701_451_391_92, -0.362_021_471_406_909_68, 0.053_661_067_120_363_44, -0.028_060_666_133_855_496, -0.023_781_213_727_103_3, 0.0, 0.026_918_042_619_289_89, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.015_697_058_325_222_042, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.461_607_524_220_211_19, 0.211_394_651_669_811_32, 0.127_033_091_716_710_92, 0.231_854_055_029_870_83, -0.338_526_640_668_837_29, 0.052_982_519_721_942_36, -0.027_504_613_658_871_878, -0.023_619_061_853_955_272, 0.0, 0.026_684_580_895_040_36, 0.011_396_834_602_855_415, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.014_389_648_842_912_164, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.206_901_219_123_788_5, 0.250_562_855_463_937_63, 0.130_333_291_570_212_73, 0.224_671_775_926_352_21, 1.308_419_325_781_946_5, 0.002_589_750_180_376_236, 0.008_070_743_254_562_857, -0.012_675_682_553_928_294, 0.0, 0.011_291_580_723_733_217, 0.034_220_566_807_097_5, -0.114_972_636_873_414_2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.014_523_480_298_010_42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.521_424_310_246_581_82, 0.186_669_884_420_460_39, 0.129_931_635_445_127_3, 0.226_214_108_576_571_93, 0.610_458_263_946_671_07, 0.014_187_156_070_224_125, 0.014_800_610_544_122_458, -0.003_711_471_609_871_774_5, 0.0, 0.001_393_256_979_572_558_9, 1.114_731_020_624_073_3, -1.021_208_555_757_145_9, -0.279_565_079_291_234_07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.008_711_816_186_418_632, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.015_329_932_473_265_604, -0.001_943_250_606_288_015_2, 0.001_072_095_950_570_478_4, 0.000_260_123_303_607_438_1, -0.018_177_185_214_102_193, -0.000_987_766_833_899_671_3, -0.003_332_383_192_417_756_5, -0.000_860_583_335_271_428_1, 0.0, 0.001_392_810_143_886_650_7, -0.161_741_998_789_763, 0.148_515_656_130_604_43, 0.022_890_510_952_530_62, -0.001_429_777_169_141_779_2, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.027_100_926_287_141_796, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.692_310_498_600_388_5, -0.067_252_431_321_644_94, 0.088_084_406_592_694_6, 0.059_825_663_121_996_31, -0.825_129_031_481_552_4, -0.048_864_533_875_083_057, -0.168_260_837_156_651_2, -0.044_431_705_037_436_08, 0.0, 0.070_378_446_394_327_8, -8.818_686_397_504_859, 8.028_821_919_603_921, 1.306_591_406_499_157_9, -0.162_488_330_722_401_47, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.014_664_424_268_579_612, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.189_839_956_139_912_45, 0.037_115_306_519_075_37, 0.131_624_798_119_951_04, 0.146_662_292_882_268_57, -0.237_733_116_246_783_84, -0.024_930_712_321_929_498, -0.094_277_770_492_213_08, -0.027_266_676_276_909_41, 0.0, 0.040_976_594_040_633_62, -5.538_725_321_977_494_5, 4.973_442_175_247_713, 0.862_629_444_918_985_9, -0.225_021_394_821_789_31, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.011_912_526_899_209_2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.672_313_785_813_087_6, 0.180_128_426_682_568_89, 0.136_568_944_744_934_72, 0.211_103_839_379_890_66, 0.777_585_472_624_472_9, 0.023_621_179_485_059_396, 0.063_913_256_075_812_3, 0.011_976_542_892_461_645, 0.0, -0.021_886_221_450_870_318, 3.500_218_060_218_659_4, -3.195_765_244_251_373_6, -0.599_440_104_860_014_83, 0.011_377_107_372_277_294, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.011_840_120_140_746_043, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.664_126_328_976_879, 0.178_891_406_187_319_4, 0.136_756_264_228_708_5, 0.210_775_811_973_028_61, 0.767_918_474_480_633_5, 0.023_134_968_695_802_974, 0.062_306_057_059_997_07, 0.011_570_990_291_938_663, 0.0, -0.021_294_416_010_421_843, 3.163_166_251_075_345_4, -2.819_544_872_276_817_2, -0.397_876_904_630_975_88, 0.130_482_177_761_573_7, 0.0, 0.0, 0.0, 0.0, 0.0],
    ];

    #[rustfmt::skip]
    const BI: [[f64; 9]; 26] = [
        [1.0, -60.671_564_990_962_76, 669.417_333_989_096_5, -3_377.878_946_225_199_4, 9_286.468_967_391_047, -14_780.477_136_811_02, 13_604.993_863_282_247, -6_724.705_443_356_114, 1_381.867_933_411_056_5],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, -0.597_216_760_566_844_7, 47.936_048_364_131_67, -565.717_041_700_233_2, 2_799.622_707_202_858_6, -7_032.161_794_919_679, 9_404.154_583_498_766, -6_374.661_804_344_304, 1_720.369_337_666_28],
        [0.0, 0.134_984_470_796_006_97, -10.834_629_145_944_527, 127.864_823_186_993_43, -632.777_936_777_218_7, 1_589.427_325_412_255_5, -2_125.551_246_305_557_2, 1_440.817_483_665_754_9, -388.842_309_780_701_1],
        [0.0, 0.072_907_476_067_532_66, -5.851_972_901_033_216, 69.062_029_738_762_994, -341.774_442_716_209_7, 858.477_527_120_137_3, -1_148.047_443_579_864_1, 778.210_749_640_921_4, -210.020_539_601_353_93],
        [0.0, 0.128_853_484_734_578_56, -10.342_520_980_591_798, 122.057_211_066_254_16, -604.037_203_213_700_4, 1_517.235_637_581_122_8, -2_029.008_844_152_904_1, 1_375.375_645_376_320_9, -371.181_116_850_131_56],
        [0.0, 0.695_897_172_076_238_74, -55.856_705_135_748_31, 659.192_634_079_572_8, -3_262.215_084_140_846_3, 8_194.112_807_588_29, -10_958.039_044_672_966, 7_427.971_576_643_476, -2_004.632_548_946_417_3],
        [0.0, 0.026_176_680_581_326_23, -2.101_090_775_094_604_5, 24.796_012_566_600_32, -122.710_603_910_578_77, 308.227_540_243_681_4, -412.194_645_100_066_96, 279.408_578_064_554_48, -75.405_718_003_049_09],
        [0.0, 0.078_456_651_612_620_75, -6.297_381_611_696_195, 74.318_518_472_037_83, -367.787_774_705_650_02, 923.818_459_990_864, -1_235.428_287_659_738_9, 837.442_371_605_615_4, -226.005_743_111_108_05],
        [0.0, 0.017_432_399_824_119_97, -1.399_224_563_421_080_7, 16.512_941_882_067_312, -81.719_311_330_651_92, 205.264_594_249_812_81, -274.501_644_179_880_53, 186.072_563_019_500_15, -50.216_551_375_567_664],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, -0.031_202_370_347_393_56, 2.505_323_513_858_665_4, -29.632_099_441_822_69, 147.173_574_899_191_83, -371.668_262_629_709_6, 500.803_253_762_596_74, -342.949_046_514_438_8, 93.798_458_780_671_25],
        [0.0, 1.005_189_184_600_557_6, -80.145_247_628_498_56, 904.286_287_161_854, -4_159.377_900_797_261, 9_382.948_440_638_74, -10_865.074_362_321_895, 6_171.218_731_586_134, -1_354.861_137_823_673_2],
        [0.0, -1.018_790_304_892_149, 81.229_685_434_330_87, -916.522_099_840_849_9, 4_215.658_051_870_923, -9_509.908_233_268_86, 11_012.088_661_364_27, -6_254.720_911_673_139, 1_373.193_636_418_218_9],
        [0.0, 0.014_867_563_831_625_919, -1.185_413_256_701_197_5, 13.375_128_087_739_488, -61.520_574_820_481_6, 138.781_422_449_831_19, -160.703_267_695_199_84, 91.277_333_477_520_88, -20.039_495_806_540_545],
        [0.0, -0.002_611_963_106_691_748_9, 0.208_255_752_438_779_78, -2.349_769_034_664_475_3, 10.808_056_622_683_037, -24.381_395_596_370_474, 28.232_668_855_390_138, -16.035_783_011_964_465, 3.520_578_375_594_150_1],
        [0.0, 61.751_365_685_088_68, -750.126_891_055_288_4, 3_898.685_586_244_842, -10_841.822_728_647_458, 17_321.575_664_625_166, -15_937.704_924_918_137, 7_853.047_625_862_507, -1_605.405_697_796_720_3],
        [0.0, -1.934_298_042_224_096_8, 147.588_643_166_560_36, -1_181.453_462_187_681_9, 4_124.816_268_317_402_5, -7_708.555_106_592_447, 8_052.349_419_898_65, -4_443.023_055_054_952, 1_010.211_590_494_692_4],
        [0.0, 0.912_642_830_786_966_65, -71.317_106_090_194_79, 695.456_144_607_544_6, -2_620.882_193_436_484_4, 4_957.008_141_154_35, -5_038.298_085_544_128, 2_633.333_935_059_078_6, -556.213_478_580_953_75],
        [0.0, -0.465_443_997_074_799_17, 37.090_998_104_441_54, -417.138_222_833_985_5, 1_920.758_799_061_188_2, -4_409.960_156_149_581_7, 5_383.383_503_749_768, -3_353.518_501_772_742, 839.849_023_837_986_28],
        [0.0, -0.117_645_170_825_521_86, 9.481_894_819_354_299, -114.915_675_829_831_94, 591.319_329_131_246_7, -1_559.765_475_086_581_5, 2_198.545_841_718_649_3, -1_564.562_048_273_728_3, 440.013_778_691_717_02],
    ];
}
